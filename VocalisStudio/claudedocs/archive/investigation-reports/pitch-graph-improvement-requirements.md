# ピッチグラフ改善要件

## 背景

スペクトログラムで実装された縦軸・横軸の扱い、フルスクリーン表示機能をピッチグラフにも適用したい。

**作成日**: 2025-11-20

---

## 1. 現状の問題点

### 1.1 軸ラベルがない

- 周波数（Y軸）のラベルがなく、どの音高か判断しにくい
- 時間（X軸）のラベルがなく、再生位置が不明確

### 1.2 スクロールできない

- 周波数範囲がデータに応じて自動調整されるため、見たい範囲を選べない
- 時間軸は再生位置中心で固定され、前後の確認ができない

### 1.3 フルスクリーン表示が簡易的

- 拡大表示しても詳細な分析がしにくい
- スペクトログラムと操作感が異なる

---

## 2. 要件

### 2.1 縦軸（周波数）

| ID | 要件 | 優先度 |
|----|------|--------|
| Y-1 | 周波数ラベルを左端に固定表示する | 高 |
| Y-2 | 縦スクロールで周波数範囲を移動できる | 高 |
| Y-3 | 周波数範囲を固定する（80-1000Hz） | 中 |
| Y-4 | ラベル間隔を適切に設定する（100Hz単位） | 中 |

### 2.2 横軸（時間）

| ID | 要件 | 優先度 |
|----|------|--------|
| X-1 | 時間ラベルを下端に固定表示する | 高 |
| X-2 | 再生位置を示す線を固定表示する | 高 |
| X-3 | 横ドラッグでシーク（再生位置移動）できる | 中 |
| X-4 | 再生に応じて自動スクロールする | 高 |

### 2.3 フルスクリーン表示

| ID | 要件 | 優先度 |
|----|------|--------|
| F-1 | 拡大ボタンでフルスクリーン表示に切り替えられる | 高 |
| F-2 | フルスクリーン時も軸ラベルが固定表示される | 高 |
| F-3 | フルスクリーン時も縦横スクロールが動作する | 高 |
| F-4 | 縮小ボタンで元のサイズに戻れる | 高 |

### 2.4 既存機能との互換性

| ID | 要件 | 優先度 |
|----|------|--------|
| C-1 | ターゲットスケールライン（目標周波数）が表示される | 高 |
| C-2 | 信頼度に応じたドット表示が維持される | 中 |
| C-3 | タップで再生/一時停止できる | 中 |

---

## 3. 受け入れ基準

### 3.1 軸ラベル

- [ ] 周波数ラベルが100Hz間隔で表示される
- [ ] 時間ラベルが0.5秒間隔で表示される
- [ ] 縦スクロールしても周波数ラベルが左端に固定される
- [ ] 横スクロールしても時間ラベルが下端に固定される

### 3.2 スクロール

- [ ] 縦ドラッグで周波数範囲をスクロールできる
- [ ] 横ドラッグで再生位置を移動（シーク）できる
- [ ] 再生中は自動的に横スクロールする
- [ ] 再生位置を示す線が常に同じ位置に表示される

### 3.3 フルスクリーン

- [ ] 拡大ボタンをタップするとフルスクリーン表示になる
- [ ] フルスクリーン時に全機能（スクロール、軸ラベル）が動作する
- [ ] 縮小ボタンをタップすると元のサイズに戻る

### 3.4 パフォーマンス

- [ ] スクロールがスムーズに動作する（カクつきがない）
- [ ] 長い録音（30秒以上）でも正常に動作する

---

## 4. 対象外（スコープ外）

- ピンチズームによる拡大縮小
- 周波数範囲のカスタマイズ（設定画面）
- 複数のピッチラインの同時表示

---

## 5. 参考

### スペクトログラムで実現済みの機能

- キャンバスベースの2Dスクロール
- 軸ラベルの固定表示（translateByによる補正）
- 再生位置の固定表示
- ドラッグ方向判定（縦/横）

### 関連ドキュメント

- `spectrogram-resolution-zoom-guide.md`
- `pitch-graph-axis-fullscreen-implementation-plan.md`

---

**最終更新**: 2025-11-20
