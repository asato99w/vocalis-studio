# ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆå®Ÿè£…ãƒ¬ãƒãƒ¼ãƒˆ

**ä½œæˆæ—¥**: 2025-11-12
**å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**: `VocalisStudio/Presentation/Views/AnalysisView.swift`
**é–¢é€£UIãƒ†ã‚¹ãƒˆ**: `VocalisStudioUITests/AnalysisUITests.swift::testSpectrogramViewport_Screenshots()`

## 1. å®Ÿè£…ã®ç›®çš„

ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ è¡¨ç¤ºã«ãŠã„ã¦ã€ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ­£ã—ãå®Ÿè£…ã™ã‚‹ã€‚ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã¯ã€ŒèƒŒé¢ã®å¤§ããªã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’è¦—ãçª“ã€ã¨ã—ã¦æ©Ÿèƒ½ã—ã€ã‚¹ãƒšã‚¯ãƒˆãƒ«å…¨ä½“ãŒãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã®é«˜ã•ã‚’åŸ‹ã‚ã‚‹ã‚ˆã†ã«è¡¨ç¤ºã™ã‚‹ã€‚

## 2. å®Ÿè£…å†…å®¹

### 2.1 ä¸»è¦ãªä¿®æ­£

#### A. ã‚»ãƒ«é«˜ã•è¨ˆç®—ã®æ ¹æœ¬çš„ãªæ›¸ãç›´ã— (lines 703-780)

**ä¿®æ­£å‰ã®å•é¡Œ**:
```swift
// è¤‡é›‘ã§èª¤ã£ãŸè¨ˆç®—å¼ã«ã‚ˆã‚Šã€ã‚»ãƒ«é«˜ã•ãŒç´„0.2ptã¨ã„ã†æ¥µå°å€¤ã«ãªã£ã¦ã„ãŸ
let frequencyRatio = freqRange / getMaxFrequency()
let cellHeight = baseCellHeight * (viewportHeight / totalCanvasHeight) * (1.0 / CGFloat(frequencyRatio))
```
â†’ ã‚»ãƒ«ãŒå®Ÿè³ªçš„ã«è¦‹ãˆãªã„çŠ¶æ…‹

**ä¿®æ­£å¾Œ**:
```swift
// å„å‘¨æ³¢æ•°ãƒ“ãƒ³ã®å®Ÿéš›ã®å‘¨æ³¢æ•°ç¯„å›²ã‚’ç›´æ¥ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆåº§æ¨™ã«ãƒãƒƒãƒ”ãƒ³ã‚°
func frequencyToViewportY(_ freq: Double) -> CGFloat {
    let ratio = (visibleRange.maxFreq - freq) / freqRange
    return viewportHeight * CGFloat(ratio)
}

let yTop = frequencyToViewportY(min(binFreqHigh, visibleRange.maxFreq))
let yBottom = frequencyToViewportY(max(binFreqLow, visibleRange.minFreq))
let cellHeight = yBottom - yTop
```

**åŠ¹æœ**:
- å„å‘¨æ³¢æ•°ãƒ“ãƒ³ãŒå ã‚ã‚‹ã¹ããƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆä¸Šã®é«˜ã•ã‚’æ­£ç¢ºã«è¨ˆç®—
- ã‚¹ãƒšã‚¯ãƒˆãƒ«ãŒãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆå…¨ä½“ã®é«˜ã•ã‚’åŸ‹ã‚ã‚‹ã‚ˆã†ã«ãªã£ãŸ

#### B. éŸ³å£°ãƒ‡ãƒ¼ã‚¿ãŒãªã„é ˜åŸŸã®è¡¨ç¤º (lines 748-755)

**è¦ä»¶**: "éŸ³å£°æ¤œå‡ºã§ããªã„éƒ¨åˆ†ã«ã¤ã„ã¦ã‚‚ã‚¹ãƒšã‚¯ãƒˆãƒ«ã®ä¸€ç•ªå¼±ã„è‰²ã«ã—ã¦æ¬²ã—ã„"

**å®Ÿè£…**:
```swift
// Get magnitude (or use 0 if no data)
let magnitude: Float
if timeIndex < data.magnitudes.count && freqIndex < data.magnitudes[timeIndex].count {
    magnitude = data.magnitudes[timeIndex][freqIndex]
} else {
    magnitude = 0.0  // No data - show weakest color
}
```

**åŠ¹æœ**:
- éŸ³å£°ãƒ‡ãƒ¼ã‚¿ãŒãªã„æ™‚é–“å¸¯ãŒè–„ã„è‰²ï¼ˆã‚°ãƒ¬ãƒ¼ï¼‰ã§è¡¨ç¤ºã•ã‚Œã‚‹
- ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ å…¨ä½“ãŒæ™‚é–“è»¸æ–¹å‘ã«é€£ç¶šçš„ã«è¦‹ãˆã‚‹

#### C. Xåº§æ¨™ã‚ªãƒ•ã‚»ãƒƒãƒˆã®ä¿®æ­£ (line 747)

**ä¿®æ­£å‰**:
```swift
let x = centerX + CGFloat(timeOffset) * pixelsPerSecond + labelWidth
```
â†’ Yè»¸ãƒ©ãƒ™ãƒ«å¹…åˆ†ã ã‘å³ã«ãšã‚Œã¦ã—ã¾ã„ã€å·¦å³ã«ç©ºç™½ãŒç”Ÿã˜ã¦ã„ãŸ

**ä¿®æ­£å¾Œ**:
```swift
let x = centerX + CGFloat(timeOffset) * pixelsPerSecond
```

**åŠ¹æœ**:
- ã‚¹ãƒšã‚¯ãƒˆãƒ«ãŒã‚­ãƒ£ãƒ³ãƒã‚¹å…¨ä½“ã®å¹…ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†ã«ãªã£ãŸ

#### D. æç”»é †åºã®å¤‰æ›´ (lines 478-497)

**ä¿®æ­£å¾Œã®æç”»é †åº**:
1. ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ï¼ˆèƒŒæ™¯ï¼‰
2. å†ç”Ÿä½ç½®ãƒ©ã‚¤ãƒ³
3. æ™‚é–“è»¸
4. Yè»¸å‘¨æ³¢æ•°ãƒ©ãƒ™ãƒ«ï¼ˆå‰æ™¯ï¼‰

**åŠ¹æœ**:
- ãƒ©ãƒ™ãƒ«ãŒã‚¹ãƒšã‚¯ãƒˆãƒ«ã®ä¸Šã«æç”»ã•ã‚Œã‚‹ãŸã‚ã€ç†è«–çš„ã«ã¯è¦‹ãˆã‚‹ã¯ãš

### 2.2 ãã®ä»–ã®é–¢é€£ä¿®æ­£

#### `getMaxFrequency()` ã®æ”¹å–„ (lines 587-597)

**ä¿®æ­£å‰**: å›ºå®šã§10kHz
**ä¿®æ­£å¾Œ**: å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã®æœ€å¤§å‘¨æ³¢æ•°ã‚’ä½¿ç”¨ï¼ˆãŸã ã—10kHzã§ã‚­ãƒ£ãƒƒãƒ—ï¼‰

```swift
private func getMaxFrequency() -> Double {
    guard let data = spectrogramData,
          !data.frequencyBins.isEmpty,
          let maxBinFreq = data.frequencyBins.max() else {
        return 10000.0  // Default fallback
    }
    // Use actual data maximum, but cap at 10kHz
    return min(10000.0, Double(maxBinFreq))
}
```

## 3. æ¤œè¨¼çµæœï¼ˆUIãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆåˆ†æï¼‰

### 3.1 ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

**ãƒ†ã‚¹ãƒˆ**: `testSpectrogramViewport_Screenshots()`
**çµæœ**: âœ… TEST SUCCEEDED
**ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ**: 3æšï¼ˆinitial/scrolled_down/scrolled_upï¼‰

### 3.2 æˆåŠŸã—ã¦ã„ã‚‹ç‚¹

#### âœ… ã‚¹ãƒšã‚¯ãƒˆãƒ«ãŒãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆå…¨ä½“ã®é«˜ã•ã‚’åŸ‹ã‚ã¦ã„ã‚‹

**ä¿®æ­£å‰**ï¼ˆ`/tmp/spectrogram_screenshots/spectrogram_01_initial.png`ï¼‰:
- ã‚¹ãƒšã‚¯ãƒˆãƒ«ãŒä¸­å¤®ã®ç‹­ã„ç¯„å›²ï¼ˆç´„30%ç¨‹åº¦ï¼‰ã«ã—ã‹è¡¨ç¤ºã•ã‚Œã¦ã„ãªã„
- å·¦å³ã«å¤§ããªç©ºç™½é ˜åŸŸ
- 2ã¤ã®ãƒ–ãƒ­ãƒƒã‚¯ã«åˆ†æ–­ã•ã‚Œã¦ã„ã‚‹

**ä¿®æ­£å¾Œ**ï¼ˆ`/tmp/spectrogram_final/C9114531-0DF4-44CE-BDDB-814FC2E73C2E.png`ï¼‰:
- ã‚¹ãƒšã‚¯ãƒˆãƒ«ãŒãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã®å…¨é«˜ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹
- é€£ç¶šçš„ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹

#### âœ… éŸ³å£°ãƒ‡ãƒ¼ã‚¿ãŒãªã„éƒ¨åˆ†ãŒè–„ã„è‰²ã§è¡¨ç¤º

- å·¦å³ã®ã‚°ãƒ¬ãƒ¼é ˜åŸŸãŒã€éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã®ãªã„æ™‚é–“å¸¯ã‚’æ­£ã—ãç¤ºã—ã¦ã„ã‚‹
- `magnitude = 0.0` ã«ã‚ˆã‚‹æœ€å¼±è‰²ã®è¡¨ç¤ºãŒæ©Ÿèƒ½ã—ã¦ã„ã‚‹

#### âœ… å‘¨æ³¢æ•°ç¯„å›²ãƒ™ãƒ¼ã‚¹ã®ãƒãƒƒãƒ”ãƒ³ã‚°ãŒæ­£ã—ãå‹•ä½œ

- å„å‘¨æ³¢æ•°ãƒ“ãƒ³ã®å®Ÿéš›ã®å‘¨æ³¢æ•°ç¯„å›²ãŒãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆåº§æ¨™ã«æ­£ç¢ºã«ãƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹

### 3.3 æ®‹ã£ã¦ã„ã‚‹å•é¡Œ

#### âŒ å•é¡Œ1: Yè»¸ãƒ©ãƒ™ãƒ«ãŒå…¨ãè¦‹ãˆãªã„

**ç¾è±¡**:
- 3æšã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã™ã¹ã¦ã§ã€ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã®Yè»¸ãƒ©ãƒ™ãƒ«ãŒ1ã¤ã‚‚è¡¨ç¤ºã•ã‚Œã¦ã„ãªã„
- æç”»é †åºã¯ä¿®æ­£æ¸ˆã¿ï¼ˆã‚¹ãƒšã‚¯ãƒˆãƒ«â†’ãƒ©ãƒ™ãƒ«ï¼‰ãªã®ã«è¦‹ãˆãªã„

**èª¿æŸ»çµæœ**:
```swift
// drawFrequencyLabels() - line 649
let labelInterval: Double = 1000.0  // 1kHz intervals
```

**æ ¹æœ¬åŸå› **:
- ãƒ©ãƒ™ãƒ«é–“éš”ãŒå›ºå®šã§1kHzï¼ˆ1000Hzï¼‰
- ã—ã‹ã—å®Ÿéš›ã®å¯è¦–å‘¨æ³¢æ•°ç¯„å›²ã¯éå¸¸ã«ç‹­ã„ï¼ˆç´„130Hzï½132Hzç¨‹åº¦ï¼‰
- ãƒ”ãƒƒãƒåˆ†æã‚°ãƒ©ãƒ•ã®Yè»¸ã«ã€Œ132Hzã€ã€Œ131Hzã€ã¨è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‹ã‚‰ç¢ºèªã§ãã‚‹
- 1kHzé–“éš”ã§ã¯ã€ã“ã®ç‹­ã„ç¯„å›²ï¼ˆ2Hzå¹…ï¼‰ã«1ã¤ã‚‚ãƒ©ãƒ™ãƒ«ãŒç”Ÿæˆã•ã‚Œãªã„

**ä¾‹**:
- å¯è¦–ç¯„å›²: 130Hzï½132Hzï¼ˆå¹…2Hzï¼‰
- ãƒ©ãƒ™ãƒ«ç”Ÿæˆ: `floor(130/1000)*1000 = 0Hz` ã‹ã‚‰ `ceil(132/1000)*1000 = 1000Hz` ã¾ã§ã€1kHzé–“éš”
- çµæœ: 0Hz, 1000Hz ã®ã¿ç”Ÿæˆã•ã‚Œã‚‹
- 0Hzã¯ç¯„å›²å¤–ï¼ˆ130Hzæœªæº€ï¼‰ã§ã‚¹ã‚­ãƒƒãƒ—
- 1000Hzã‚‚ç¯„å›²å¤–ï¼ˆ132Hzè¶…ï¼‰ã§ã‚¹ã‚­ãƒƒãƒ—
- **ç”Ÿæˆã•ã‚Œã‚‹ãƒ©ãƒ™ãƒ«æ•°: 0å€‹**

#### âŒ å•é¡Œ2: å‚ç›´ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãŒæ©Ÿèƒ½ã—ã¦ã„ãªã„å¯èƒ½æ€§

**ç¾è±¡**:
- 3ã¤ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆï¼ˆinitial/scrolled_down/scrolled_upï¼‰ãŒã™ã¹ã¦åŒã˜è¦‹ãŸç›®
- UIãƒ†ã‚¹ãƒˆã§ã¯å‚ç›´ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼ã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ã¯ãš

**å¯èƒ½æ€§ã®ã‚ã‚‹åŸå› **:
1. ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼ãŒæ­£ã—ãèªè­˜ã•ã‚Œã¦ã„ãªã„
2. å‚ç›´ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ç¯„å›²ã®è¨ˆç®—ã«å•é¡ŒãŒã‚ã‚‹
3. `verticalScrollOffset` ã®æ›´æ–°ãŒåæ˜ ã•ã‚Œã¦ã„ãªã„
4. å¯è¦–ç¯„å›²ã®è¨ˆç®—ã¯æ­£ã—ã„ãŒã€è¦–è¦šçš„ãªå¤‰åŒ–ãŒå°ã•ã™ãã¦åˆ†ã‹ã‚‰ãªã„

## 4. å¿…è¦ãªè¿½åŠ ä¿®æ­£

### 4.1 å„ªå…ˆåº¦: é«˜ - Yè»¸ãƒ©ãƒ™ãƒ«é–“éš”ã®å‹•çš„èª¿æ•´

**ç›®çš„**: å¯è¦–å‘¨æ³¢æ•°ç¯„å›²ã«å¿œã˜ã¦é©åˆ‡ãªãƒ©ãƒ™ãƒ«é–“éš”ã‚’ä½¿ç”¨ã™ã‚‹

**å®Ÿè£…æ–¹é‡**:
```swift
private func calculateLabelInterval(freqRange: Double) -> Double {
    if freqRange < 10 {
        return 1.0      // 1Hzé–“éš”ï¼ˆ10Hzæœªæº€ã®ç¯„å›²ï¼‰
    } else if freqRange < 100 {
        return 10.0     // 10Hzé–“éš”ï¼ˆ10Hzï½100Hzã®ç¯„å›²ï¼‰
    } else if freqRange < 1000 {
        return 100.0    // 100Hzé–“éš”ï¼ˆ100Hzï½1kHzã®ç¯„å›²ï¼‰
    } else if freqRange < 5000 {
        return 500.0    // 500Hzé–“éš”ï¼ˆ1kHzï½5kHzã®ç¯„å›²ï¼‰
    } else {
        return 1000.0   // 1kHzé–“éš”ï¼ˆ5kHzä»¥ä¸Šã®ç¯„å›²ï¼‰
    }
}
```

**æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ**:
- ç‹­ã„ç¯„å›²ï¼ˆ130Hzï½132Hzï¼‰ã§ã¯1Hzé–“éš”ã§ã€Œ130Hz, 131Hz, 132Hzã€ã®ã‚ˆã†ãªãƒ©ãƒ™ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- åºƒã„ç¯„å›²ï¼ˆ0ï½10kHzï¼‰ã§ã¯1kHzé–“éš”ã§ã€Œ0k, 1k, 2k, ..., 10kã€ã®ã‚ˆã†ãªãƒ©ãƒ™ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹

### 4.2 å„ªå…ˆåº¦: ä¸­ - å‚ç›´ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å‹•ä½œã®æ¤œè¨¼

**èª¿æŸ»é …ç›®**:
1. `verticalScrollOffset` ã®å€¤ãŒå®Ÿéš›ã«å¤‰åŒ–ã—ã¦ã„ã‚‹ã‹
2. `getVisibleFrequencyRange()` ãŒæ­£ã—ã„å¯è¦–ç¯„å›²ã‚’è¿”ã—ã¦ã„ã‚‹ã‹
3. ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ç¯„å›²ï¼ˆ`totalCanvasHeight`ï¼‰ã®è¨ˆç®—ãŒé©åˆ‡ã‹

**ãƒ‡ãƒãƒƒã‚°æ–¹æ³•**:
- `drawFrequencyLabels()` ã§å¯è¦–ç¯„å›²ã‚’ãƒ­ã‚°å‡ºåŠ›
- UIãƒ†ã‚¹ãƒˆã«å¾…æ©Ÿæ™‚é–“ã‚’è¿½åŠ ã—ã¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†ã‚’å¾…ã¤

### 4.3 å„ªå…ˆåº¦: ä½ - ãƒ©ãƒ™ãƒ«è¡¨ç¤ºæ•°ã®æœ€é©åŒ–

**ç›®çš„**: ãƒ©ãƒ™ãƒ«ãŒå¯†é›†ã—ã™ããŸã‚Šã€å°‘ãªã™ããŸã‚Šã—ãªã„ã‚ˆã†ã«ã™ã‚‹

**å®Ÿè£…æ–¹é‡**:
```swift
// ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã®é«˜ã•ã«åŸºã¥ã„ã¦ã€é©åˆ‡ãªãƒ©ãƒ™ãƒ«æ•°ã‚’è¨ˆç®—
let optimalLabelCount = Int(viewportHeight / 40.0)  // 40pté–“éš”ãŒç›®å®‰
let calculatedInterval = freqRange / Double(optimalLabelCount)
// calculatedIntervalã‚’é©åˆ‡ãªå€¤ï¼ˆ1, 2, 5, 10, 20, 50, 100, ...ï¼‰ã«ä¸¸ã‚ã‚‹
```

## 5. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ç†è§£ã®ç¢ºèª

### ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã®æ­£ã—ã„ç†è§£

**ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã¨ã¯**: ã€ŒèƒŒé¢ã®å¤§ããªã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’è¦—ãçª“ã€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Virtual Canvas (ä»®æƒ³ã‚­ãƒ£ãƒ³ãƒã‚¹)      â”‚
â”‚  - 0Hzï½10kHzå…¨ä½“ã‚’å«ã‚€å¤§ããªé ˜åŸŸ    â”‚
â”‚  - ã‚¹ãƒšã‚¯ãƒˆãƒ«ã¨ãƒ©ãƒ™ãƒ«ãŒæç”»ã•ã‚Œã‚‹    â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â† Viewport       â”‚
â”‚  â”‚ è¦‹ãˆã¦ã„ã‚‹éƒ¨åˆ† â”‚   (ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆ)  â”‚
â”‚  â”‚ ä¾‹: 130-132Hz â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ**:
1. ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã¯ã‚­ãƒ£ãƒ³ãƒã‚¹ã®ä¸€éƒ¨ã‚’ã€Œè¦—ã„ã¦ã„ã‚‹ã€ã ã‘
2. ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆè‡ªä½“ã«ã¯ä½•ã‚‚æç”»ã•ã‚Œãªã„
3. ã™ã¹ã¦ã®æç”»ã¯ã‚­ãƒ£ãƒ³ãƒã‚¹åº§æ¨™ç³»ã§è¡Œã‚ã‚Œã‚‹
4. ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆã¯å˜ã«ã©ã®éƒ¨åˆ†ãŒè¦‹ãˆã‚‹ã‹ã‚’æ±ºå®šã™ã‚‹

### åº§æ¨™å¤‰æ›ã®æµã‚Œ

```
å‘¨æ³¢æ•°å€¤ï¼ˆHzï¼‰
  â†“ frequencyToCanvasY()
ã‚­ãƒ£ãƒ³ãƒã‚¹Yåº§æ¨™
  â†“ å¯è¦–ç¯„å›²ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚° + ã‚ªãƒ•ã‚»ãƒƒãƒˆèª¿æ•´
ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆYåº§æ¨™
  â†“ Canvasæç”»
ç”»é¢ä¸Šã®ãƒ”ã‚¯ã‚»ãƒ«
```

## 6. æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **Yè»¸ãƒ©ãƒ™ãƒ«é–“éš”ã®å‹•çš„èª¿æ•´ã‚’å®Ÿè£…** ï¼ˆå„ªå…ˆåº¦: é«˜ï¼‰
   - `calculateLabelInterval()` é–¢æ•°ã‚’è¿½åŠ 
   - `drawFrequencyLabels()` ã‚’ä¿®æ­£
   - UIãƒ†ã‚¹ãƒˆã§æ¤œè¨¼

2. **å‚ç›´ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã®å‹•ä½œç¢ºèª** ï¼ˆå„ªå…ˆåº¦: ä¸­ï¼‰
   - ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°è¿½åŠ 
   - UIãƒ†ã‚¹ãƒˆã®å¾…æ©Ÿæ™‚é–“èª¿æ•´
   - ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ç¯„å›²ã®æ¤œè¨¼

3. **ãƒ©ãƒ™ãƒ«è¡¨ç¤ºã®æœ€é©åŒ–** ï¼ˆå„ªå…ˆåº¦: ä½ï¼‰
   - ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆé«˜ã•ã«åŸºã¥ããƒ©ãƒ™ãƒ«æ•°ã®èª¿æ•´
   - ãƒ©ãƒ™ãƒ«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®æ”¹å–„ï¼ˆä¾‹: 1500Hz â†’ 1.5kï¼‰

## 7. å‚è€ƒè³‡æ–™

- **å®Ÿè£…è¨ˆç”»**: `claudedocs/spectrogram_viewport_architecture_plan.md`
- **ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆæŠ½å‡ºæ–¹æ³•**: `claudedocs/UITEST_SCREENSHOT_EXTRACTION.md`
- **ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: `VocalisStudioUITests/AnalysisUITests.swift`

## 8. å¤‰æ›´å±¥æ­´

| æ—¥ä»˜ | ã‚³ãƒŸãƒƒãƒˆ | å¤‰æ›´å†…å®¹ |
|------|---------|---------|
| 2025-11-12 | - | ã‚»ãƒ«é«˜ã•è¨ˆç®—ã®æ›¸ãç›´ã—ã€éŸ³å£°ãªã—é ˜åŸŸã®è¡¨ç¤ºã€Xåº§æ¨™ã‚ªãƒ•ã‚»ãƒƒãƒˆä¿®æ­£ã€æç”»é †åºå¤‰æ›´ |

---

**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: ğŸŸ¡ éƒ¨åˆ†çš„ã«å®Œäº†ï¼ˆã‚¹ãƒšã‚¯ãƒˆãƒ«è¡¨ç¤ºã¯æ”¹å–„ã€Yè»¸ãƒ©ãƒ™ãƒ«ã¯æœªè§£æ±ºï¼‰
