# ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ è§£åƒåº¦ã¨ã‚ºãƒ¼ãƒ èª¿æ•´ã‚¬ã‚¤ãƒ‰

## æ¦‚è¦

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã®ãƒ‡ãƒ¼ã‚¿è§£åƒåº¦ã¨è¡¨ç¤ºã‚ºãƒ¼ãƒ ã‚’é©åˆ‡ã«èª¿æ•´ã™ã‚‹æ–¹æ³•ã¨ã€é¿ã‘ã‚‹ã¹ãã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚

**é‡è¦ãªåŸå‰‡**:
- **ãƒ‡ãƒ¼ã‚¿è§£åƒåº¦**ï¼ˆFFTåˆ†æã®ç²¾åº¦ï¼‰ã¨**è¡¨ç¤ºã‚ºãƒ¼ãƒ **ï¼ˆç”»é¢ä¸Šã®æ‹¡å¤§ç‡ï¼‰ã¯åˆ¥ç‰©
- ä¸¡è€…ã‚’é©åˆ‡ã«ãƒãƒ©ãƒ³ã‚¹ã•ã›ã‚‹ã“ã¨ã§ã€è©³ç´°ã‹ã¤è¦‹ã‚„ã™ã„ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ãŒå®Ÿç¾ã§ãã‚‹

---

## 1. ãƒ‡ãƒ¼ã‚¿è§£åƒåº¦ã®æ”¹å–„

ãƒ‡ãƒ¼ã‚¿è§£åƒåº¦ã¯ã€éŸ³éŸ¿ä¿¡å·ã‚’ã©ã‚Œã ã‘ç´°ã‹ãåˆ†æã™ã‚‹ã‹ã‚’æ±ºå®šã—ã¾ã™ã€‚

### 1.1 å‘¨æ³¢æ•°è§£åƒåº¦ã®å‘ä¸Š

#### âœ… æ­£ã—ã„æ–¹æ³•: FFTãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºã‚’å¢—ã‚„ã™

```swift
// AudioFileAnalyzer.swift

// âŒ é–“é•ã„: ãƒ“ãƒ³æ•°ã ã‘å¢—ã‚„ã™
private let spectrogramFreqBins = 400
private let spectrogramBufferSize = 4096  // ç†è«–åˆ†è§£èƒ½: 10.76Hz/bin
// â†’ 400ãƒ“ãƒ³ Ã· 2000Hz = 5Hz/bin ã¯ç†è«–åˆ†è§£èƒ½ã‚’è¶…ãˆã¦ã„ã‚‹ï¼

// âœ… æ­£è§£: FFTãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºã‚‚å¢—ã‚„ã™
private let spectrogramFreqBins = 400
private let spectrogramBufferSize = 8192  // ç†è«–åˆ†è§£èƒ½: 5.38Hz/bin
// â†’ 400ãƒ“ãƒ³ Ã· 2000Hz = 5Hz/bin ã¯ç†è«–åˆ†è§£èƒ½å†… âœ“
```

**ç†è«–çš„ãªå‘¨æ³¢æ•°åˆ†è§£èƒ½ã®è¨ˆç®—**:
```
å‘¨æ³¢æ•°åˆ†è§£èƒ½ = ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ / FFTãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚º
            = 44100Hz / 8192 â‰ˆ 5.38Hz/bin
```

**ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³**:
- 1ãƒ“ãƒ³ã‚ãŸã‚Šã®å‘¨æ³¢æ•°å¹…ã¯ã€ç†è«–åˆ†è§£èƒ½ä»¥ä¸Šã«ã™ã‚‹
- ç†è«–åˆ†è§£èƒ½ã‚ˆã‚Šç´°ã‹ãã—ã¦ã‚‚ã€å®Ÿè³ªçš„ãªæƒ…å ±ã¯å¢—ãˆãªã„
- FFTãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºã¯2ã®ç´¯ä¹—ï¼ˆ1024, 2048, 4096, 8192, 16384...ï¼‰

#### ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•

| FFTãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚º | å‘¨æ³¢æ•°åˆ†è§£èƒ½ | æ™‚é–“åˆ†è§£èƒ½ | å‡¦ç†è² è· |
|------------------|------------|----------|--------|
| 2048 | ä½ã„ï¼ˆ21.5Hzï¼‰ | é«˜ã„ | ä½ã„ |
| 4096 | ä¸­ï¼ˆ10.8Hzï¼‰ | ä¸­ | ä¸­ |
| 8192 | é«˜ã„ï¼ˆ5.4Hzï¼‰ | ã‚„ã‚„ä½ã„ | ã‚„ã‚„é«˜ã„ |
| 16384 | éå¸¸ã«é«˜ã„ï¼ˆ2.7Hzï¼‰ | ä½ã„ | é«˜ã„ |

**ãƒœãƒ¼ã‚«ãƒ«åˆ†æã®æ¨å¥¨å€¤**: 4096ã€œ8192ï¼ˆå‘¨æ³¢æ•°ç²¾åº¦ã¨æ™‚é–“å¿œç­”ã®ãƒãƒ©ãƒ³ã‚¹ãŒè‰¯ã„ï¼‰

### 1.2 æ™‚é–“è§£åƒåº¦ã®å‘ä¸Š

#### âœ… æ­£ã—ã„æ–¹æ³•: ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°é–“éš”ã‚’çŸ­ãã™ã‚‹

```swift
// AudioFileAnalyzer.swift

// âŒ é–“é•ã„: é–“éš”ãŒé•·ã™ãã‚‹
private let spectrogramSamplingInterval = 0.1  // 100ms â†’ 1ç§’é–“ã«10ãƒ•ãƒ¬ãƒ¼ãƒ 

// âœ… æ­£è§£: é©åˆ‡ãªé–“éš”
private let spectrogramSamplingInterval = 0.05  // 50ms â†’ 1ç§’é–“ã«20ãƒ•ãƒ¬ãƒ¼ãƒ 
```

**ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³**:
- ãƒœãƒ¼ã‚«ãƒ«åˆ†æ: 50msï¼ˆ20fpsï¼‰ãŒæ¨å¥¨
- ã‚ˆã‚Šç´°ã‹ã„æ™‚é–“å¤‰åŒ–ã‚’æ‰ãˆã‚‹å ´åˆ: 25msï¼ˆ40fpsï¼‰
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤ºã®å ´åˆ: å‡¦ç†è² è·ã¨ã®ãƒãƒ©ãƒ³ã‚¹ã‚’è€ƒæ…®

#### ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•

| ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°é–“éš” | æ™‚é–“è§£åƒåº¦ | ãƒ‡ãƒ¼ã‚¿é‡ | å‡¦ç†æ™‚é–“ |
|----------------|----------|---------|---------|
| 100ms | æ¨™æº– | 1x | 1x |
| 50ms | 2å€ | 2x | ç´„1.5x |
| 25ms | 4å€ | 4x | ç´„2.5x |

### 1.3 å‘¨æ³¢æ•°ç¯„å›²ã®æ‹¡å¤§

#### âœ… æ­£ã—ã„æ–¹æ³•: è§£åƒåº¦ã‚’ç¶­æŒã—ãªãŒã‚‰ç¯„å›²ã‚’æ‹¡å¤§

```swift
// AudioFileAnalyzer.swift

// è§£åƒåº¦5Hz/binã‚’ä¿ã¡ã¤ã¤ã€2000Hzâ†’6000Hzã«æ‹¡å¤§
private let spectrogramFreqBins = 1200  // 6000 / 5 = 1200
private let spectrogramMaxFreq = 6000.0
// â†’ 1ãƒ“ãƒ³ã‚ãŸã‚Š 5Hz ã‚’ç¶­æŒ âœ“
```

**è¨ˆç®—æ–¹æ³•**:
```
å¿…è¦ãªãƒ“ãƒ³æ•° = å‘¨æ³¢æ•°ç¯„å›²(Hz) / ç›®æ¨™è§£åƒåº¦(Hz/bin)
ä¾‹: 6000Hz Ã· 5Hz/bin = 1200ãƒ“ãƒ³
```

---

## 2. è¡¨ç¤ºã‚ºãƒ¼ãƒ ã®èª¿æ•´

è¡¨ç¤ºã‚ºãƒ¼ãƒ ã¯ã€ç”»é¢ä¸Šã§ãƒ‡ãƒ¼ã‚¿ã‚’ã©ã‚Œã ã‘æ‹¡å¤§ã—ã¦è¡¨ç¤ºã™ã‚‹ã‹ã‚’æ±ºå®šã—ã¾ã™ã€‚

### 2.1 å‘¨æ³¢æ•°è»¸ã®ã‚ºãƒ¼ãƒ 

å‘¨æ³¢æ•°è»¸ã®ã‚ºãƒ¼ãƒ ã¯**2ã¤ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**ã§åˆ¶å¾¡ã—ã¾ã™ï¼š

1. **maxFreq**: è¡¨ç¤ºã™ã‚‹å‘¨æ³¢æ•°ç¯„å›²ï¼ˆ0ã€œmaxFreqï¼‰
2. **basePixelsPerKHz**: 1kHzã‚ãŸã‚Šã®ãƒ”ã‚¯ã‚»ãƒ«æ•°ï¼ˆãƒ”ã‚¯ã‚»ãƒ«å¯†åº¦ï¼‰

#### âœ… æ­£ã—ã„æ–¹æ³•: ä¸¡æ–¹ã‚’èª¿æ•´ã—ã¦ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚‹

```swift
// AnalysisView.swift

// Canvas heightã‚’é©åº¦ã«ä¿ã¡ã¤ã¤ã‚ºãƒ¼ãƒ ã™ã‚‹ä¾‹

// å…ƒã®è¨­å®š
maxFreq = 12000Hz
basePixelsPerKHz = 60pt/kHz
Canvas height = 12 Ã— 60 = 720pt
ãƒ‡ãƒ¼ã‚¿ç¯„å›²(0-2000Hz)ã®é«˜ã• = 2 Ã— 60 = 120pt

// ã‚ºãƒ¼ãƒ å¾Œï¼ˆmaxFreqã‚’ä¸‹ã’ã€ãƒ”ã‚¯ã‚»ãƒ«å¯†åº¦ã‚’ä¸Šã’ã‚‹ï¼‰
maxFreq = 6000Hz
basePixelsPerKHz = 864pt/kHz
Canvas height = 6 Ã— 864 = 5184pt
ãƒ‡ãƒ¼ã‚¿ç¯„å›²(0-2000Hz)ã®é«˜ã• = 2 Ã— 864 = 1728ptï¼ˆ14.4å€ã‚ºãƒ¼ãƒ  âœ“ï¼‰
```

**ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³**:
- Canvas heightã¯10000ptä»¥ä¸‹ã«æŠ‘ãˆã‚‹ï¼ˆãƒ¡ãƒ¢ãƒªåˆ¶ç´„ï¼‰
- ãƒ‡ãƒ¼ã‚¿ç¯„å›²å…¨ä½“ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«maxFreqã‚’è¨­å®š
- ãƒ”ã‚¯ã‚»ãƒ«å¯†åº¦ã¨ãƒ©ãƒ™ãƒ«é–“éš”ã®ãƒãƒ©ãƒ³ã‚¹ã‚’è€ƒæ…®

#### Canvas Heightè¨ˆç®—å¼

```swift
private func calculateCanvasHeight(maxFreq: Double, viewportHeight: CGFloat) -> CGFloat {
    let basePixelsPerKHz: CGFloat = 864.0
    let canvasHeight = CGFloat(maxFreq / 1000.0) * basePixelsPerKHz

    // æœ€å¤§åˆ¶é™ã‚’é©ç”¨
    let maxHeight: CGFloat = 10000.0
    return min(maxHeight, canvasHeight)
}
```

### 2.2 æ™‚é–“è»¸ã®ã‚ºãƒ¼ãƒ 

æ™‚é–“è»¸ã®ã‚ºãƒ¼ãƒ ã¯**pixelsPerSecond**ã§åˆ¶å¾¡ã—ã¾ã™ã€‚

#### âœ… æ­£ã—ã„æ–¹æ³•: 3ç®‡æ‰€ã™ã¹ã¦ã§åŒã˜å€¤ã‚’ä½¿ç”¨

```swift
// AnalysisView.swift

// âš ï¸ é‡è¦: ä»¥ä¸‹ã®3ç®‡æ‰€ã§å¿…ãšåŒã˜å€¤ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨

// 1. Canvas widthè¨ˆç®—
let pixelsPerSecond: CGFloat = 300  // â† ã“ã®å€¤ã‚’

// 2. ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ æç”»ï¼ˆdrawSpectrogramOnCanvasï¼‰
let pixelsPerSecond: CGFloat = 300  // â† ã“ã“ã¨

// 3. æ™‚é–“è»¸ãƒ©ãƒ™ãƒ«æç”»ï¼ˆdrawSpectrogramTimeAxisï¼‰
let pixelsPerSecond: CGFloat = 300  // â† ã“ã“ã§ä¸€è‡´ã•ã›ã‚‹
```

**âŒ ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³**: å€¤ãŒä¸ä¸€è‡´ã ã¨ãšã‚ŒãŒç™ºç”Ÿ

```swift
// âŒ é–“é•ã„: å€¤ãŒä¸€è‡´ã—ã¦ã„ãªã„
let pixelsPerSecond: CGFloat = 300  // Canvas widthè¨ˆç®—
// ...
let pixelsPerSecond: CGFloat = 150  // ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ æç”»ï¼ˆå¤ã„å€¤ã®ã¾ã¾ï¼‰
// â†’ ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã¨æ™‚é–“è»¸ãƒ©ãƒ™ãƒ«ãŒãšã‚Œã‚‹ï¼
```

### 2.3 ãƒ©ãƒ™ãƒ«é–“éš”ã®èª¿æ•´

ã‚ºãƒ¼ãƒ ã«å¿œã˜ã¦ãƒ©ãƒ™ãƒ«é–“éš”ã‚’èª¿æ•´ã—ã€è¦‹ã‚„ã™ã•ã‚’ä¿ã¡ã¾ã™ã€‚

#### å‘¨æ³¢æ•°ãƒ©ãƒ™ãƒ«é–“éš”

```swift
// AnalysisView.swift - drawFrequencyLabelsOnCanvas()

// ãƒ”ã‚¯ã‚»ãƒ«å¯†åº¦ã«å¿œã˜ã¦èª¿æ•´
basePixelsPerKHz = 60pt/kHz  â†’ labelInterval = 1000Hz (1kHz)
basePixelsPerKHz = 432pt/kHz â†’ labelInterval = 500Hz (0.5kHz)
basePixelsPerKHz = 864pt/kHz â†’ labelInterval = 250Hz (0.25kHz)
```

**æ¨å¥¨ãƒ©ãƒ™ãƒ«é–“éš”ã®è¨ˆç®—**:
```
ãƒ©ãƒ™ãƒ«é–“ã®ãƒ”ã‚¯ã‚»ãƒ«è·é›¢ = labelInterval Ã— basePixelsPerKHz / 1000
ç›®å®‰: 100ã€œ300ptç¨‹åº¦ãŒèª­ã¿ã‚„ã™ã„
```

#### æ™‚é–“ãƒ©ãƒ™ãƒ«é–“éš”

```swift
// AnalysisView.swift - drawSpectrogramTimeAxis()

// ãƒ”ã‚¯ã‚»ãƒ«å¯†åº¦ã«å¿œã˜ã¦èª¿æ•´
pixelsPerSecond = 50pt/s  â†’ labelInterval = 1.0s
pixelsPerSecond = 150pt/s â†’ labelInterval = 0.5s
pixelsPerSecond = 300pt/s â†’ labelInterval = 0.25s
```

---

## 3. æ­£ã—ã„å®Ÿè£…æ‰‹é †

### 3.1 ãƒ‡ãƒ¼ã‚¿è§£åƒåº¦ã‚’å‘ä¸Šã•ã›ã‚‹å ´åˆ

#### Step 1: FFTãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºã‚’æ±ºå®š

```swift
// ç›®æ¨™ã®å‘¨æ³¢æ•°åˆ†è§£èƒ½ã‹ã‚‰é€†ç®—
ç›®æ¨™è§£åƒåº¦ = 5Hz/bin
å¿…è¦ãªFFTã‚µã‚¤ã‚º = ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ / ç›®æ¨™è§£åƒåº¦
                = 44100 / 5 â‰ˆ 8820
â†’ 2ã®ç´¯ä¹—ã§8192ã‚’é¸æŠ
```

#### Step 2: ãƒ“ãƒ³æ•°ã‚’è¨ˆç®—

```swift
// å‘¨æ³¢æ•°ç¯„å›²ã¨è§£åƒåº¦ã‹ã‚‰è¨ˆç®—
å‘¨æ³¢æ•°ç¯„å›² = 6000Hz
è§£åƒåº¦ = 5Hz/bin
å¿…è¦ãªãƒ“ãƒ³æ•° = 6000 / 5 = 1200ãƒ“ãƒ³
```

#### Step 3: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®š

```swift
// AudioFileAnalyzer.swift
private let spectrogramBufferSize = 8192
private let spectrogramFreqBins = 1200
private let spectrogramMaxFreq = 6000.0
private let spectrogramSamplingInterval = 0.05  // 50ms
```

#### Step 4: ãƒ“ãƒ«ãƒ‰ã¨ãƒ†ã‚¹ãƒˆ

```bash
xcodebuild build
./scripts/test-runner.sh unit
```

### 3.2 è¡¨ç¤ºã‚ºãƒ¼ãƒ ã‚’èª¿æ•´ã™ã‚‹å ´åˆ

#### Step 1: ç›®æ¨™ã‚ºãƒ¼ãƒ å€ç‡ã‚’æ±ºå®š

```
ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ç¯„å›²ã®è¡¨ç¤ºé«˜ã•: 120pt
ç›®æ¨™ã®è¡¨ç¤ºé«˜ã•: 1728pt
ã‚ºãƒ¼ãƒ å€ç‡ = 1728 / 120 = 14.4å€
```

#### Step 2: ãƒ”ã‚¯ã‚»ãƒ«å¯†åº¦ã‚’è¨ˆç®—

```
æ–°ã—ã„basePixelsPerKHz = å…ƒã®basePixelsPerKHz Ã— ã‚ºãƒ¼ãƒ å€ç‡
                      = 60 Ã— 14.4 = 864pt/kHz
```

#### Step 3: maxFreqã‚’èª¿æ•´ã—ã¦Canvas heightã‚’é©åˆ‡ã«ä¿ã¤

```
ç›®æ¨™Canvas height = 5000ptï¼ˆä¾‹ï¼‰
maxFreq = ç›®æ¨™Canvas height / basePixelsPerKHz Ã— 1000
        = 5000 / 864 Ã— 1000 â‰ˆ 5787Hz â†’ 6000Hzã«ä¸¸ã‚ã‚‹
```

#### Step 4: ãƒ©ãƒ™ãƒ«é–“éš”ã‚’èª¿æ•´

```swift
// å‘¨æ³¢æ•°ãƒ©ãƒ™ãƒ«
let labelInterval: Double = 250.0  // 864pt/kHz Ã— 0.25kHz = 216pté–“éš”

// æ™‚é–“ãƒ©ãƒ™ãƒ«
let labelInterval: Double = 0.25  // 300pt/s Ã— 0.25s = 75pté–“éš”
```

#### Step 5: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šï¼ˆ3ç®‡æ‰€ã™ã¹ã¦ï¼‰

```swift
// AnalysisView.swift

// 1. Canvas widthè¨ˆç®—
let pixelsPerSecond: CGFloat = 300

// 2. calculateCanvasHeight()
let basePixelsPerKHz: CGFloat = 864.0

// 3. getMaxFrequency()
return 6000.0

// 4. drawSpectrogramOnCanvas()
let pixelsPerSecond: CGFloat = 300

// 5. drawSpectrogramTimeAxis()
let pixelsPerSecond: CGFloat = 300
let labelInterval: Double = 0.25

// 6. drawFrequencyLabelsOnCanvas()
let labelInterval: Double = 250.0
```

#### Step 6: ãƒ“ãƒ«ãƒ‰ã¨ãƒ†ã‚¹ãƒˆ

```bash
xcodebuild build
./scripts/test-runner.sh unit
```

---

## 4. ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å›é¿æ–¹æ³•

### 4.1 FFTãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºã‚’å¤‰ãˆãšã«ãƒ“ãƒ³æ•°ã ã‘å¢—ã‚„ã™

#### âŒ ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³

```swift
// ç†è«–åˆ†è§£èƒ½ã‚’è¶…ãˆãŸè¨­å®š
private let spectrogramBufferSize = 4096  // 10.76Hz/bin
private let spectrogramFreqBins = 1200    // 6000Hz / 1200 = 5Hz/bin
// â†’ 5Hz/bin < 10.76Hz/bin ãªã®ã§ç‰©ç†çš„ã«å®Ÿç¾ä¸å¯èƒ½
```

**å•é¡Œç‚¹**:
- å®Ÿè³ªçš„ãªå‘¨æ³¢æ•°æƒ…å ±ã¯å¢—ãˆãªã„
- åŒã˜FFTå‡ºåŠ›å€¤ãŒè¤‡æ•°ã®ãƒ“ãƒ³ã«åˆ†æ•£ã™ã‚‹ã ã‘
- ãƒ¡ãƒ¢ãƒªã¨å‡¦ç†æ™‚é–“ã‚’ç„¡é§„ã«æ¶ˆè²»

#### âœ… æ­£ã—ã„æ–¹æ³•

```swift
// FFTãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºã‚’å¢—ã‚„ã—ã¦ç†è«–åˆ†è§£èƒ½ã‚’å‘ä¸Š
private let spectrogramBufferSize = 8192  // 5.38Hz/bin
private let spectrogramFreqBins = 1200    // 6000Hz / 1200 = 5Hz/bin
// â†’ 5Hz/bin â‰ˆ 5.38Hz/bin ã§ç†è«–åˆ†è§£èƒ½å†… âœ“
```

### 4.2 è¡¨ç¤ºãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ä¸ä¸€è‡´

#### âŒ ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³

```swift
// Canvas widthè¨ˆç®—
let pixelsPerSecond: CGFloat = 300

// ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ æç”»ï¼ˆå¤ã„å€¤ã®ã¾ã¾ï¼‰
let pixelsPerSecond: CGFloat = 150  // â† ä¸ä¸€è‡´ï¼

// æ™‚é–“è»¸ãƒ©ãƒ™ãƒ«æç”»
let pixelsPerSecond: CGFloat = 300
```

**å•é¡Œç‚¹**:
- ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã¨æ™‚é–“è»¸ãƒ©ãƒ™ãƒ«ãŒãšã‚Œã‚‹
- ãƒ‡ãƒ¼ã‚¿ã¨è¡¨ç¤ºã®æ•´åˆæ€§ãŒå´©ã‚Œã‚‹
- ãƒ‡ãƒãƒƒã‚°ãŒå›°é›£

#### âœ… æ­£ã—ã„æ–¹æ³•

```swift
// ã™ã¹ã¦ã®ç®‡æ‰€ã§åŒã˜å€¤ã‚’ä½¿ç”¨
let pixelsPerSecond: CGFloat = 300  // â† 3ç®‡æ‰€ã™ã¹ã¦ã§çµ±ä¸€
```

**æ¨å¥¨**: å®šæ•°åŒ–ã—ã¦ä¸€ç®‡æ‰€ã§ç®¡ç†

```swift
// ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ è¡¨ç¤ºã®å®šæ•°
private struct SpectrogramDisplayConstants {
    static let pixelsPerSecond: CGFloat = 300
    static let basePixelsPerKHz: CGFloat = 864
    static let maxFrequency: Double = 6000.0
}
```

### 4.3 Canvas heightãŒå¤§ãããªã‚Šã™ãã‚‹

#### âŒ ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³

```swift
// ãƒ”ã‚¯ã‚»ãƒ«å¯†åº¦ã‚’ä¸Šã’ã™ãã¦Canvas heightãŒå·¨å¤§ã«
maxFreq = 12000Hz
basePixelsPerKHz = 864pt/kHz
Canvas height = 12 Ã— 864 = 10368pt  // â† ãƒ¡ãƒ¢ãƒªè² è·å¤§
```

**å•é¡Œç‚¹**:
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãŒå¢—å¤§
- æç”»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒä½ä¸‹
- ãƒ‡ãƒã‚¤ã‚¹ã«ã‚ˆã£ã¦ã¯ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã®å¯èƒ½æ€§

#### âœ… æ­£ã—ã„æ–¹æ³•

```swift
// maxFreqã‚’ä¸‹ã’ã¦Canvas heightã‚’é©åˆ‡ã«ä¿ã¤
maxFreq = 6000Hz
basePixelsPerKHz = 864pt/kHz
Canvas height = 6 Ã— 864 = 5184pt  // â† é©åˆ‡ãªç¯„å›²

// ã¾ãŸã¯æœ€å¤§åˆ¶é™ã‚’è¨­ã‘ã‚‹
let maxHeight: CGFloat = 10000.0
return min(maxHeight, canvasHeight)
```

### 4.4 ãƒ‡ãƒ¼ã‚¿ç¯„å›²ã¨è¡¨ç¤ºç¯„å›²ã®ä¸ä¸€è‡´

#### âŒ ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³

```swift
// ãƒ‡ãƒ¼ã‚¿ã¯6000Hzã¾ã§åˆ†æã—ã¦ã„ã‚‹ã®ã«
spectrogramMaxFreq = 6000.0

// è¡¨ç¤ºã¯2000Hzã¾ã§ã—ã‹è¦‹ãˆãªã„
maxFreq = 2000.0  // â† ãƒ‡ãƒ¼ã‚¿ã®ä¸€éƒ¨ã—ã‹è¦‹ãˆãªã„
```

**å•é¡Œç‚¹**:
- ã›ã£ã‹ãåˆ†æã—ãŸé«˜å‘¨æ³¢æ•°å¸¯åŸŸãŒè¦‹ãˆãªã„
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå…¨ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèªã§ããªã„

#### âœ… æ­£ã—ã„æ–¹æ³•

```swift
// ãƒ‡ãƒ¼ã‚¿ç¯„å›²ã¨è¡¨ç¤ºç¯„å›²ã‚’ä¸€è‡´ã•ã›ã‚‹
spectrogramMaxFreq = 6000.0
maxFreq = 6000.0  // â† ãƒ‡ãƒ¼ã‚¿å…¨ä½“ãŒè¡¨ç¤ºå¯èƒ½
```

### 4.5 åˆæœŸã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã®ä¸çµ±ä¸€

#### âŒ ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³

```swift
// Normal Viewã¯ä¸Šç«¯ï¼ˆé«˜å‘¨æ³¢ï¼‰ã€Expanded Viewã¯ä¸‹ç«¯ï¼ˆä½å‘¨æ³¢ï¼‰
.onAppear {
    if isExpanded {
        paperTop = minPaperTop  // ä¸‹ç«¯
    }
    // Normal Viewã¯åˆæœŸåŒ–ãªã— â†’ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ä¸Šç«¯
}
```

**å•é¡Œç‚¹**:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®ä¸çµ±ä¸€
- é‡è¦ãªä½å‘¨æ³¢æ•°å¸¯åŸŸï¼ˆåŸºæœ¬å‘¨æ³¢æ•°ï¼‰ãŒè¦‹ãˆãªã„å ´åˆãŒã‚ã‚‹

#### âœ… æ­£ã—ã„æ–¹æ³•

```swift
// ä¸¡æ–¹ã®Viewã§ä¸‹ç«¯ï¼ˆä½å‘¨æ³¢æ•°ï¼‰ã‚’åˆæœŸè¡¨ç¤º
.onAppear {
    paperTop = minPaperTop  // å¸¸ã«ä¸‹ç«¯ã‚’è¡¨ç¤º
}
```

---

## 5. ä»Šå›ã®å¤‰æ›´å±¥æ­´

### Phase 1: å‘¨æ³¢æ•°ãƒ“ãƒ³æ•°ã®å¢—åŠ ï¼ˆåˆå›æ”¹å–„ï¼‰

**å¤‰æ›´å†…å®¹**:
```swift
spectrogramFreqBins: 20 â†’ 100
```

**åŠ¹æœ**:
- å‘¨æ³¢æ•°è§£åƒåº¦: 100Hz/bin â†’ 20Hz/binï¼ˆ5å€å‘ä¸Šï¼‰

### Phase 2: æ™‚é–“è§£åƒåº¦ã®å‘ä¸Š

**å¤‰æ›´å†…å®¹**:
```swift
spectrogramFreqBins: 100 â†’ 200
spectrogramSamplingInterval: 0.1s â†’ 0.05s
```

**åŠ¹æœ**:
- å‘¨æ³¢æ•°è§£åƒåº¦: 20Hz/bin â†’ 10Hz/binï¼ˆ2å€å‘ä¸Šï¼‰
- æ™‚é–“è§£åƒåº¦: 100ms â†’ 50msï¼ˆ2å€å‘ä¸Šï¼‰

### Phase 3: FFTãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºã®å¢—åŠ ï¼ˆæ¨å¥¨æ–¹å¼ï¼‰

**å¤‰æ›´å†…å®¹**:
```swift
spectrogramBufferSize: 4096 â†’ 8192
spectrogramFreqBins: 200 â†’ 400
```

**åŠ¹æœ**:
- ç†è«–å‘¨æ³¢æ•°åˆ†è§£èƒ½: 10.76Hz/bin â†’ 5.38Hz/binï¼ˆ2å€å‘ä¸Šï¼‰
- å®ŸåŠ¹è§£åƒåº¦: 10Hz/bin â†’ 5Hz/binï¼ˆ2å€å‘ä¸Šï¼‰

### Phase 4: å‘¨æ³¢æ•°ç¯„å›²ã®æ‹¡å¤§

**å¤‰æ›´å†…å®¹**:
```swift
spectrogramMaxFreq: 2000Hz â†’ 6000Hz
spectrogramFreqBins: 400 â†’ 1200
```

**åŠ¹æœ**:
- åˆ†æç¯„å›²: 0-2000Hz â†’ 0-6000Hzï¼ˆ3å€æ‹¡å¤§ï¼‰
- è§£åƒåº¦ç¶­æŒ: 5Hz/binï¼ˆå¤‰æ›´ãªã—ï¼‰

### è¡¨ç¤ºã‚ºãƒ¼ãƒ èª¿æ•´ã®å¤‰æ›´å±¥æ­´

#### å‘¨æ³¢æ•°è»¸

**Step 1**: åˆå›ã‚ºãƒ¼ãƒ ï¼ˆ2.4å€ï¼‰
```swift
maxFreq: 12000Hz â†’ 5000Hz
basePixelsPerKHz: 60pt/kHz â†’ 144pt/kHz
```

**Step 2**: ã•ã‚‰ã«3å€ã‚ºãƒ¼ãƒ 
```swift
maxFreq: 5000Hz â†’ 2500Hz
basePixelsPerKHz: 144pt/kHz â†’ 432pt/kHz
ãƒ©ãƒ™ãƒ«é–“éš”: 1000Hz â†’ 500Hz
```

**Step 3**: ã•ã‚‰ã«2å€ã‚ºãƒ¼ãƒ 
```swift
maxFreq: 2500Hz â†’ 1250Hz
basePixelsPerKHz: 432pt/kHz â†’ 864pt/kHz
ãƒ©ãƒ™ãƒ«é–“éš”: 500Hz â†’ 250Hz
```

**Step 4**: ãƒ‡ãƒ¼ã‚¿ç¯„å›²ã«åˆã‚ã›ã¦èª¿æ•´
```swift
maxFreq: 1250Hz â†’ 6000Hzï¼ˆãƒ‡ãƒ¼ã‚¿å…¨ä½“ã‚’è¡¨ç¤ºï¼‰
basePixelsPerKHz: 864pt/kHzï¼ˆç¶­æŒï¼‰
```

**æœ€çµ‚åŠ¹æœ**: å…ƒã®60pt/kHzã‹ã‚‰864pt/kHzã¸14.4å€ã®ã‚ºãƒ¼ãƒ 

#### æ™‚é–“è»¸

**Step 1**: åˆå›ã‚ºãƒ¼ãƒ ï¼ˆ3å€ï¼‰
```swift
pixelsPerSecond: 50pt/s â†’ 150pt/s
ãƒ©ãƒ™ãƒ«é–“éš”: 1.0s â†’ 0.5s
```

**Step 2**: ã•ã‚‰ã«2å€ã‚ºãƒ¼ãƒ 
```swift
pixelsPerSecond: 150pt/s â†’ 300pt/s
ãƒ©ãƒ™ãƒ«é–“éš”: 0.5s â†’ 0.25s
```

**æœ€çµ‚åŠ¹æœ**: å…ƒã®50pt/sã‹ã‚‰300pt/sã¸6å€ã®ã‚ºãƒ¼ãƒ 

### è¡¨ç¤ºç¯„å›²ã®çµ±ä¸€

**å¤‰æ›´å†…å®¹**:
```swift
// Normal View
maxFreq: 8000Hz â†’ 6000Hz
åˆæœŸã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®: ä¸Šç«¯ â†’ ä¸‹ç«¯

// Expanded View
maxFreq: 6000Hzï¼ˆå¤‰æ›´ãªã—ï¼‰
åˆæœŸã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®: ä¸‹ç«¯ï¼ˆå¤‰æ›´ãªã—ï¼‰
```

**åŠ¹æœ**:
- ä¸¡ãƒ¢ãƒ¼ãƒ‰ã§ä¸€è²«ã—ãŸè¡¨ç¤ºç¯„å›²ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“

---

## 6. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ—©è¦‹è¡¨

### æœ€çµ‚çš„ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š

#### ãƒ‡ãƒ¼ã‚¿è§£åƒåº¦ï¼ˆAudioFileAnalyzer.swiftï¼‰

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | å€¤ | èª¬æ˜ |
|----------|-----|------|
| spectrogramBufferSize | 8192 | FFTãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºï¼ˆç†è«–åˆ†è§£èƒ½: 5.38Hz/binï¼‰ |
| spectrogramFreqBins | 1200 | å‘¨æ³¢æ•°ãƒ“ãƒ³æ•° |
| spectrogramMaxFreq | 6000.0Hz | åˆ†æã™ã‚‹æœ€å¤§å‘¨æ³¢æ•° |
| spectrogramSamplingInterval | 0.05s | æ™‚é–“ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°é–“éš”ï¼ˆ50msï¼‰ |
| å®ŸåŠ¹å‘¨æ³¢æ•°è§£åƒåº¦ | 5Hz/bin | 6000Hz Ã· 1200ãƒ“ãƒ³ |
| å®ŸåŠ¹æ™‚é–“è§£åƒåº¦ | 20fps | 1ç§’ Ã· 0.05s |

#### è¡¨ç¤ºã‚ºãƒ¼ãƒ ï¼ˆAnalysisView.swiftï¼‰

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | å€¤ | èª¬æ˜ |
|----------|-----|------|
| maxFreq | 6000.0Hz | è¡¨ç¤ºã™ã‚‹æœ€å¤§å‘¨æ³¢æ•° |
| basePixelsPerKHz | 864pt/kHz | å‘¨æ³¢æ•°è»¸ã®ãƒ”ã‚¯ã‚»ãƒ«å¯†åº¦ |
| pixelsPerSecond | 300pt/s | æ™‚é–“è»¸ã®ãƒ”ã‚¯ã‚»ãƒ«å¯†åº¦ |
| å‘¨æ³¢æ•°ãƒ©ãƒ™ãƒ«é–“éš” | 250Hz | 0.25kHzé–“éš” |
| æ™‚é–“ãƒ©ãƒ™ãƒ«é–“éš” | 0.25s | 250msé–“éš” |
| Canvas height | 5184pt | 6kHz Ã— 864pt/kHz |

### æ”¹å–„å€ç‡ã¾ã¨ã‚

| é …ç›® | å…ƒã®å€¤ | æœ€çµ‚å€¤ | æ”¹å–„å€ç‡ |
|------|--------|--------|---------|
| **ãƒ‡ãƒ¼ã‚¿è§£åƒåº¦** |
| å‘¨æ³¢æ•°ãƒ“ãƒ³æ•° | 20 | 1200 | **60å€** |
| å‘¨æ³¢æ•°åˆ†è§£èƒ½ | 100Hz/bin | 5Hz/bin | **20å€** |
| å‘¨æ³¢æ•°ç¯„å›² | 0-2000Hz | 0-6000Hz | **3å€** |
| æ™‚é–“ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚° | 100ms | 50ms | **2å€** |
| FFTãƒãƒƒãƒ•ã‚¡ | 4096 | 8192 | **2å€** |
| **è¡¨ç¤ºã‚ºãƒ¼ãƒ ** |
| å‘¨æ³¢æ•°ãƒ”ã‚¯ã‚»ãƒ«å¯†åº¦ | 60pt/kHz | 864pt/kHz | **14.4å€** |
| æ™‚é–“ãƒ”ã‚¯ã‚»ãƒ«å¯†åº¦ | 50pt/s | 300pt/s | **6å€** |
| å‘¨æ³¢æ•°ãƒ©ãƒ™ãƒ«ç´°ã‹ã• | 1000Hz | 250Hz | **4å€** |
| æ™‚é–“ãƒ©ãƒ™ãƒ«ç´°ã‹ã• | 1.0s | 0.25s | **4å€** |

---

## 7. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### å•é¡Œ: ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã¨æ™‚é–“è»¸ãƒ©ãƒ™ãƒ«ãŒãšã‚Œã‚‹

**åŸå› **: pixelsPerSecondãŒ3ç®‡æ‰€ã§ä¸€è‡´ã—ã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:
```swift
// ä»¥ä¸‹ã®3ç®‡æ‰€ã‚’ç¢ºèªã—ã€åŒã˜å€¤ã«ã™ã‚‹
// 1. Canvas widthè¨ˆç®—ï¼ˆline 482ä»˜è¿‘ï¼‰
let pixelsPerSecond: CGFloat = 300

// 2. drawSpectrogramOnCanvasï¼ˆline 839ä»˜è¿‘ï¼‰
let pixelsPerSecond: CGFloat = 300

// 3. drawSpectrogramTimeAxisï¼ˆline 948ä»˜è¿‘ï¼‰
let pixelsPerSecond: CGFloat = 300
```

### å•é¡Œ: ãƒ¡ãƒ¢ãƒªä¸è¶³ã‚„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ä½ä¸‹

**åŸå› **: Canvas heightãŒå¤§ãã™ãã‚‹

**è§£æ±ºæ–¹æ³•**:
```swift
// maxFreqã‚’ä¸‹ã’ã‚‹ã‹ã€basePixelsPerKHzã‚’ä¸‹ã’ã‚‹
// ã¾ãŸã¯æœ€å¤§åˆ¶é™ã‚’ç¢ºèª
let maxHeight: CGFloat = 10000.0
return min(maxHeight, canvasHeight)
```

### å•é¡Œ: é«˜å‘¨æ³¢æ•°å¸¯åŸŸãŒè¡¨ç¤ºã•ã‚Œãªã„

**åŸå› **: ãƒ‡ãƒ¼ã‚¿ç¯„å›²ã¨è¡¨ç¤ºç¯„å›²ãŒä¸€è‡´ã—ã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:
```swift
// AudioFileAnalyzer.swift
private let spectrogramMaxFreq = 6000.0

// AnalysisView.swift
private func getMaxFrequency() -> Double {
    return 6000.0  // ãƒ‡ãƒ¼ã‚¿ç¯„å›²ã¨ä¸€è‡´
}
```

### å•é¡Œ: è§£åƒåº¦ã‚’ä¸Šã’ã¦ã‚‚ã¼ã‚„ã‘ã¦è¦‹ãˆã‚‹

**åŸå› **: FFTãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºãŒä¸è¶³ã—ã¦ã„ã‚‹

**è§£æ±ºæ–¹æ³•**:
```swift
// ãƒ“ãƒ³æ•°ã‚’å¢—ã‚„ã™å‰ã«FFTãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºã‚’å¢—ã‚„ã™
private let spectrogramBufferSize = 8192  // 4096ã‹ã‚‰å€å¢—
```

---

## 8. ä»Šå¾Œã®æ”¹å–„æ¡ˆ

### 8.1 å‹•çš„ãªè§£åƒåº¦èª¿æ•´

ç¾åœ¨ã¯å›ºå®šå€¤ã§ã™ãŒã€éŒ²éŸ³æ™‚é–“ã‚„ãƒ‡ãƒã‚¤ã‚¹æ€§èƒ½ã«å¿œã˜ã¦å‹•çš„ã«èª¿æ•´ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ï¼š

```swift
// éŒ²éŸ³æ™‚é–“ãŒçŸ­ã„å ´åˆã¯é«˜è§£åƒåº¦
if duration < 30 {
    spectrogramSamplingInterval = 0.025  // 25ms
} else {
    spectrogramSamplingInterval = 0.05   // 50ms
}
```

### 8.2 ã‚ºãƒ¼ãƒ ãƒ¬ãƒ™ãƒ«ã®ãƒ—ãƒªã‚»ãƒƒãƒˆ

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç°¡å˜ã«åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã‚‹ã‚ˆã†ã€è¤‡æ•°ã®ã‚ºãƒ¼ãƒ ãƒ¬ãƒ™ãƒ«ã‚’ç”¨æ„ï¼š

```swift
enum ZoomLevel {
    case overview    // å…¨ä½“ã‚’ä¸€æœ›ï¼ˆ60pt/kHzï¼‰
    case standard    // æ¨™æº–ï¼ˆ432pt/kHzï¼‰
    case detailed    // è©³ç´°ï¼ˆ864pt/kHzï¼‰
    case ultraDetail // è¶…è©³ç´°ï¼ˆ1728pt/kHzï¼‰
}
```

### 8.3 å‘¨æ³¢æ•°å¸¯åŸŸã®å‹•çš„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°

åˆ†æã™ã‚‹å‘¨æ³¢æ•°å¸¯åŸŸã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé¸æŠã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ï¼š

```swift
enum FrequencyRange {
    case vocal       // 0-2000Hzï¼ˆãƒœãƒ¼ã‚«ãƒ«åŸºéŸ³ï¼‰
    case harmonic    // 0-6000Hzï¼ˆå€éŸ³å«ã‚€ï¼‰
    case full        // 0-22050Hzï¼ˆãƒŠã‚¤ã‚­ã‚¹ãƒˆå‘¨æ³¢æ•°ã¾ã§ï¼‰
}
```

---

## 9. å‚è€ƒè³‡æ–™

### é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«

- `VocalisStudio/Infrastructure/Analysis/AudioFileAnalyzer.swift` - ãƒ‡ãƒ¼ã‚¿è§£åƒåº¦ã®è¨­å®š
- `VocalisStudio/Presentation/Views/AnalysisView.swift` - è¡¨ç¤ºã‚ºãƒ¼ãƒ ã®è¨­å®š
- `claudedocs/spectrogram-resolution-improvement.md` - åˆå›ã®è§£åƒåº¦æ”¹å–„èª¿æŸ»

### FFTã¨å‘¨æ³¢æ•°åˆ†è§£èƒ½

- FFT (Fast Fourier Transform): æ™‚é–“é ˜åŸŸã®ä¿¡å·ã‚’å‘¨æ³¢æ•°é ˜åŸŸã«å¤‰æ›
- å‘¨æ³¢æ•°åˆ†è§£èƒ½ = ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ Ã· FFTãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚º
- æ™‚é–“åˆ†è§£èƒ½ = FFTãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚º Ã· ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ
- ãƒã‚¤ã‚¼ãƒ³ãƒ™ãƒ«ã‚¯ã®ä¸ç¢ºå®šæ€§åŸç†çš„ãªãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ãŒå­˜åœ¨

### ãƒœãƒ¼ã‚«ãƒ«åˆ†æã®å‘¨æ³¢æ•°å¸¯åŸŸ

- åŸºæœ¬å‘¨æ³¢æ•°: 80Hzã€œ1000Hzï¼ˆç”·æ€§: 80-250Hzã€å¥³æ€§: 150-400Hzï¼‰
- ç¬¬1ãƒ•ã‚©ãƒ«ãƒãƒ³ãƒˆ: 300Hzã€œ1000Hz
- ç¬¬2ãƒ•ã‚©ãƒ«ãƒãƒ³ãƒˆ: 800Hzã€œ2500Hz
- ç¬¬3ãƒ•ã‚©ãƒ«ãƒãƒ³ãƒˆ: 2000Hzã€œ3500Hz
- å€éŸ³æˆåˆ†: åŸºæœ¬å‘¨æ³¢æ•°ã®æ•´æ•°å€ï¼ˆ6000Hzã¾ã§ã‚«ãƒãƒ¼ã§ååˆ†ï¼‰

---

## 10. ã¾ã¨ã‚

### âœ… æˆåŠŸã®ãƒã‚¤ãƒ³ãƒˆ

1. **FFTãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºã‚’å¢—ã‚„ã—ã¦ã‹ã‚‰**ãƒ“ãƒ³æ•°ã‚’å¢—ã‚„ã™
2. **3ç®‡æ‰€ã®pixelsPerSecond**ã‚’å¿…ãšä¸€è‡´ã•ã›ã‚‹
3. **Canvas heightã‚’é©åˆ‡ã«ä¿ã¤**ãŸã‚maxFreqã¨basePixelsPerKHzã‚’ãƒãƒ©ãƒ³ã‚¹
4. **ãƒ‡ãƒ¼ã‚¿ç¯„å›²ã¨è¡¨ç¤ºç¯„å›²ã‚’ä¸€è‡´**ã•ã›ã‚‹
5. **ãƒ©ãƒ™ãƒ«é–“éš”ã‚’èª¿æ•´**ã—ã¦è¦‹ã‚„ã™ã•ã‚’ä¿ã¤

### âŒ é¿ã‘ã‚‹ã¹ãã“ã¨

1. ç†è«–åˆ†è§£èƒ½ã‚’è¶…ãˆã¦ãƒ“ãƒ³æ•°ã ã‘å¢—ã‚„ã™
2. è¡¨ç¤ºãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ä¸ä¸€è‡´ã‚’æ”¾ç½®ã™ã‚‹
3. Canvas heightã‚’ç„¡åˆ¶é™ã«å¤§ããã™ã‚‹
4. ãƒ‡ãƒ¼ã‚¿ã®ä¸€éƒ¨ã—ã‹è¡¨ç¤ºã—ãªã„è¨­å®š
5. ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®ä¸çµ±ä¸€

### ğŸ¯ æœ€çµ‚çš„ã«é”æˆã—ãŸä»•æ§˜

- **ãƒ‡ãƒ¼ã‚¿**: 0-6000Hzã€1200ãƒ“ãƒ³ã€5Hz/binè§£åƒåº¦ã€50msé–“éš”
- **è¡¨ç¤º**: 864pt/kHzã€300pt/sã€14.4å€ï¼ˆå‘¨æ³¢æ•°ï¼‰Ã—6å€ï¼ˆæ™‚é–“ï¼‰ã®ã‚ºãƒ¼ãƒ 
- **çµæœ**: æ¥µã‚ã¦è©³ç´°ã§è¦‹ã‚„ã™ã„ãƒœãƒ¼ã‚«ãƒ«åˆ†æç”¨ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ 

---

**ä½œæˆæ—¥**: 2025-11-16
**æœ€çµ‚æ›´æ–°**: 2025-11-16
**å¯¾è±¡ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: VocalisStudio Phase 4å®Œäº†æ™‚ç‚¹
